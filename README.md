# LLMâ€¯4â€¯Stockâ€¯PredictionÂ ğŸ“ˆğŸ¤–

![Workflow diagram](./fig/workflow.png)

**LLMâ€¯4â€¯Stockâ€¯Prediction** is the research codeâ€‘base that accompanies the paper  
*â€œCanâ€¯LLMsÂ Predict the Stock Market?Â A Comparative Analysis on the NIFTYâ€¯50â€* (2025).

The repository demonstrates how four largeâ€‘language modelsâ€”**ChatGPTâ€‘o3Â Mini**, **SUTRAâ€‘light**, **Geminiâ€¯2.0Â Flash**, and **Grok 2**â€”were prompted on 12Â AprilÂ 2025 with fresh Googleâ€‘News headlines and then benchmarked against the first trading session that followed (15Â AprilÂ 2025).  
All charts, CSV/XLSX outputs, and evaluation tables found in the paper are produced directly from this code.

---

## ğŸ“‚ Repository layout

```
LLM4StockPrediction/
â”œâ”€â”€ data/          # Raw & processed CSV/XLSX generated by the notebook
â”œâ”€â”€ fig/           # All figures used in the paper (line charts, workflow, etc.)
â”œâ”€â”€ utils.py       # Helper functions for news collection & prompt generation
â”œâ”€â”€ main.ipynb     # Endâ€‘toâ€‘end experiment: fetch news â†’ prompt LLMs â†’ evaluate
â””â”€â”€ requirements.txt
```

---

## ğŸ› ï¸ Key modules

| File / object | Purpose |
|---------------|---------|
| **`utils.py`** | |
|Â `fetch_news(query, experiment)` | Scrapes the latest Googleâ€‘News headlines for a given company using SeleniumÂ +Â BeautifulSoup and returns a list of article snippets. |
|Â `create_prompt_1(query, news)` | Builds the *baseline prompt* used in the published study (no persona, ten headlines, zeroâ€‘shot). |
|Â `create_prompt_2â€¦create_prompt_6` | Placeholder generators for richer prompts (e.g.\ including lastâ€‘price context, chainâ€‘ofâ€‘thought, multilingual variants). Not used in the current paper but stubbed for future work. |
| **`main.ipynb`** | Notebook that orchestrates the full pipeline: load NIFTYâ€¯50 tickers â†’ fetch news â†’ build prompts â†’ query each LLM via API â†’ map raw responses to ratings â†’ evaluate vs actual market move â†’ save datasets â†’ plot figures. |

---

## ğŸš€ Quick start

```bash
# 1. Clone repo
git clone https://github.com/SAGAR-TAMANG/LLM4StockPrediction.git
cd LLM4StockPrediction

# 2. (Optional) create virtual environment
python -m venv .venv && source .venv/bin/activate

# 3. Install dependencies
pip install -r requirements.txt

# 4. Launch Jupyter and run the experiment
jupyter lab main.ipynb
```

> **Note:**  
> Youâ€™ll need valid API keys for each LLM provider and a local Chrome/Chromedriver
> install for Selenium. Update paths & keys in the first config cell of
> `main.ipynb`.

---

## ğŸ“Š Reproducing the paper

Running every cell in `main.ipynb` will:

1. **Scrape** the ten most recent headlines per NIFTYâ€¯50 company (as of the run date).  
2. **Prompt** the four LLMs with those headlines via `create_prompt_1`.  
3. **Generate** rating predictions in the set \\(\{-2,-1,0,1,2\}\\).  
4. **Compare** predictions to the actual intraday percentage change between 09:30â€¯andâ€¯15:30 on the next trading session, binning returns into the same fiveâ€‘point scale.  
5. **Save** intermediate CSV/XLSX to `data/` and export all figures to `fig/`.  
6. **Print** exactâ€‘match and directionalâ€‘accuracy metrics identical to TablesÂ 3Â &Â 4 in the manuscript.

---

## ğŸ—ºï¸ Roadâ€‘map

* Add `create_prompt_2Â â€¦ 6` variants:  
  * priceâ€‘anchored prompts  
  * chainâ€‘ofâ€‘thought / treeâ€‘ofâ€‘thought  
  * multilingual sentiment fusion  
* Extend horizon analysis (1â€¯day â†’ 5â€¯days) and rolling backâ€‘tests.  
* Fineâ€‘tune a financeâ€‘specific LLM and benchmark against foundation models.  
* Integrate technical indicators and macro variables for hybrid scoring.

---

## ğŸ“– Citation

If you find this code useful, please cite the companion paper:

```bibtex
@misc{tamang2025llm4stock,
  title        = {Can LLMs Predict the Stock Market? A Comparative Analysis on the NIFTY 50},
  author       = {Tamang, Sagar and Das, Upasana and Modi, Kritika and Sharma, Keshav and Bora, DibyaÂ Jyoti},
  year         = {2025},
  note         = {Working paper, arXiv preâ€‘print forthcoming},
  howpublished = {\\url{https://github.com/SAGAR-TAMANG/LLM4StockPrediction}}
}
```

---

## ğŸ“œ License

This project is released under the **MIT License**â€”see [`LICENSE`](LICENSE) for details.

Happy experimenting, and feel free to open issues or PRs!